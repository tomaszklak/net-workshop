version: '3'

services:
  client1:
    build:
      context: .
    privileged: true
    volumes:
      - ./shared/client1:/shared
    networks:
      local_1:
        ipv4_address: 192.168.0.10

  client2:
    build:
      context: .
    privileged: true
    volumes:
      - ./shared/client2:/shared
    networks:
      local_1:
        ipv4_address: 192.168.0.20

  router:
    build:
      context: .
    privileged: true
    volumes:
      - ./shared/router:/shared
    networks:
      local_1:
        ipv4_address: 192.168.0.254
      internet_1:
        ipv4_address: 1.1.0.254

  server1:
    build:
      context: .
    privileged: true
    volumes:
      - ./shared/server1:/shared
    networks:
      internet_1:
        ipv4_address: 1.1.0.10

  server2:
    build:
      context: .
    privileged: true
    volumes:
      - ./shared/server2:/shared
    networks:
      internet_1:
        ipv4_address: 1.1.0.20

networks:
  local_1:
    driver: bridge
    driver_opts:
      com.docker.network.bridge.enable_ip_masquerade: 'false'
    ipam:
      config:
        - subnet: 192.168.0.0/24
  internet_1:
    driver: bridge
    driver_opts:
      com.docker.network.bridge.enable_ip_masquerade: 'false'
    ipam:
      config:
        - subnet: 1.1.0.0/24